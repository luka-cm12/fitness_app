// Teste da API de redefini√ß√£o de senha
const API_BASE = 'http://localhost:3000/api';

// Fun√ß√£o para testar forgot-password
async function testForgotPassword() {
    console.log('üß™ Testando API de forgot-password...');
    
    try {
        const response = await fetch(`${API_BASE}/password-reset/forgot-password`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                email: 'test@example.com'
            })
        });
        
        const data = await response.json();
        console.log('‚úÖ Resposta forgot-password:', response.status, data);
        
        return response.ok;
    } catch (error) {
        console.error('‚ùå Erro forgot-password:', error);
        return false;
    }
}

// Fun√ß√£o para testar reset-password
async function testResetPassword(token) {
    console.log('üß™ Testando API de reset-password...');
    
    try {
        const response = await fetch(`${API_BASE}/password-reset/reset-password`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                token: token,
                password: 'novaSenha123!'
            })
        });
        
        const data = await response.json();
        console.log('‚úÖ Resposta reset-password:', response.status, data);
        
        return response.ok;
    } catch (error) {
        console.error('‚ùå Erro reset-password:', error);
        return false;
    }
}

// Fun√ß√£o para testar valida√ß√£o de token
async function testValidateToken(token) {
    console.log('üß™ Testando valida√ß√£o de token...');
    
    try {
        const response = await fetch(`${API_BASE}/password-reset/reset-password/validate/${token}`);
        const data = await response.json();
        console.log('‚úÖ Resposta validate-token:', response.status, data);
        
        return response.ok;
    } catch (error) {
        console.error('‚ùå Erro validate-token:', error);
        return false;
    }
}

// Executar testes
async function runTests() {
    console.log('üöÄ Iniciando testes da API de redefini√ß√£o de senha...\n');
    
    // Teste 1: Forgot Password
    const forgotResult = await testForgotPassword();
    console.log(`Resultado forgot-password: ${forgotResult ? '‚úÖ PASSOU' : '‚ùå FALHOU'}\n`);
    
    // Teste 2: Reset Password com token inv√°lido
    const resetResult = await testResetPassword('token_invalido_123');
    console.log(`Resultado reset-password (token inv√°lido): ${resetResult ? '‚ùå FALHOU' : '‚úÖ PASSOU'}\n`);
    
    // Teste 3: Validar token inv√°lido
    const validateResult = await testValidateToken('token_invalido_123');
    console.log(`Resultado validate-token (token inv√°lido): ${validateResult ? '‚ùå FALHOU' : '‚úÖ PASSOU'}\n`);
    
    console.log('üèÅ Testes conclu√≠dos!');
}

// Executar quando a p√°gina carregar
if (typeof window !== 'undefined') {
    // Executar no browser
    window.addEventListener('load', runTests);
} else {
    // Executar no Node.js
    runTests();
}